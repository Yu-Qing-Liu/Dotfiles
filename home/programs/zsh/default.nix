{ pkgs, ... }:
{
  # Ensure `vivid` (or its related functionality) is available for generating LS_COLORS
  home.packages = [
    pkgs.vivid
  ];

  # Enable Zsh
  programs.zsh = {
    enable = true;
    autocd = true;
    dotDir = ".config/zsh";
    autosuggestion.enable = true;
    enableCompletion = true;

    # Set custom aliases
    shellAliases = {
      ls = "ls --color=auto";
      grep = "grep --color=auto";
      n = "nvim $1";
      r = "ranger-cd";
      ranger = "ranger-cd";
    };

    oh-my-zsh = {
      enable = true;
      theme = "fox";
      plugins = [
        "command-not-found"
        "git"
        "history"
        "sudo"
      ];
    };

    # Extra Zsh initialization
    initExtra = ''
      SYSTEMD_EDITOR=nvim
      EDITOR=nvim
      VISUAL=nvim
      LS_COLORS="*~=3;38;2;68;68;68:bd=1;38;2;118;148;106:ca=0;38;2;135;175;0:cd=3;38;2;152;187;108:di=1;38;2;255;165;0:do=1;38;2;127;180;202:ex=1;38;2;142;192;124:fi=0;38;2;7;102;120:ln=3;38;2;230;195;132:mh=1:mi=0;38;2;7;102;120:no=0;38;2;7;102;120:or=3;38;2;114;113;105:ow=1;38;2;255;165;0:pi=0;38;2;126;156;216:rs=0:sg=0;38;2;135;175;0:so=1;38;2;126;156;216:st=0;38;2;7;102;120:su=0;38;2;7;102;120:tw=3;38;2;7;102;120:*.1=0;38;2;118;148;106:*.a=1;38;2;142;192;124:*.c=0;38;2;149;127;184:*.d=0;38;2;149;127;184:*.h=0;38;2;149;127;184:*.m=0;38;2;149;127;184:*.o=3;38;2;68;68;68:*.p=0;38;2;149;127;184:*.r=0;38;2;149;127;184:*.t=0;38;2;149;127;184:*.v=0;38;2;149;127;184:*.z=1;38;2;204;169;93:*.7z=1;38;2;204;169;93:*.ai=0;38;2;126;156;216:*.as=0;38;2;149;127;184:*.bc=3;38;2;68;68;68:*.bz=1;38;2;204;169;93:*.cc=0;38;2;149;127;184:*.cp=0;38;2;149;127;184:*.cr=0;38;2;149;127;184:*.cs=0;38;2;149;127;184:*.db=1;38;2;204;169;93:*.di=0;38;2;149;127;184:*.el=0;38;2;149;127;184:*.ex=0;38;2;149;127;184:*.fs=0;38;2;149;127;184:*.go=0;38;2;149;127;184:*.gv=0;38;2;149;127;184:*.gz=1;38;2;204;169;93:*.ha=0;38;2;149;127;184:*.hh=0;38;2;149;127;184:*.hi=3;38;2;68;68;68:*.hs=0;38;2;149;127;184:*.jl=0;38;2;149;127;184:*.js=0;38;2;149;127;184:*.ko=1;38;2;142;192;124:*.kt=0;38;2;149;127;184:*.la=3;38;2;68;68;68:*.ll=0;38;2;149;127;184:*.lo=3;38;2;68;68;68:*.ma=0;38;2;126;156;216:*.mb=0;38;2;126;156;216:*.md=0;38;2;118;148;106:*.mk=3;38;2;232;36;36:*.ml=0;38;2;149;127;184:*.mn=0;38;2;149;127;184:*.nb=0;38;2;149;127;184:*.nu=0;38;2;149;127;184:*.pl=0;38;2;149;127;184:*.pm=0;38;2;149;127;184:*.pp=0;38;2;149;127;184:*.ps=1;38;2;230;195;132:*.py=0;38;2;149;127;184:*.rb=0;38;2;149;127;184:*.rm=1;38;2;127;180;202:*.rs=0;38;2;149;127;184:*.sh=0;38;2;149;127;184:*.so=1;38;2;142;192;124:*.td=0;38;2;149;127;184:*.ts=0;38;2;149;127;184:*.ui=0;38;2;215;95;175:*.vb=0;38;2;149;127;184:*.wv=0;38;2;126;156;216:*.xz=1;38;2;204;169;93:*FAQ=0;38;2;243;210;132:*.3ds=0;38;2;126;156;216:*.3fr=0;38;2;126;156;216:*.3mf=0;38;2;126;156;216:*.adb=0;38;2;149;127;184:*.ads=0;38;2;149;127;184:*.aif=0;38;2;126;156;216:*.amf=0;38;2;126;156;216:*.ape=0;38;2;126;156;216:*.apk=1;38;2;204;169;93:*.ari=0;38;2;126;156;216:*.arj=1;38;2;204;169;93:*.arw=0;38;2;126;156;216:*.asa=0;38;2;149;127;184:*.asm=0;38;2;149;127;184:*.aux=3;38;2;68;68;68:*.avi=1;38;2;127;180;202:*.awk=0;38;2;149;127;184:*.bag=1;38;2;204;169;93:*.bak=3;38;2;68;68;68:*.bat=1;38;2;142;192;124:*.bay=0;38;2;126;156;216:*.bbl=3;38;2;68;68;68:*.bcf=3;38;2;68;68;68:*.bib=0;38;2;215;95;175:*.bin=1;38;2;135;175;95:*.blg=3;38;2;68;68;68:*.bmp=0;38;2;126;156;216:*.bsh=0;38;2;149;127;184:*.bst=0;38;2;215;95;175:*.bz2=1;38;2;204;169;93:*.c++=0;38;2;149;127;184:*.cap=0;38;2;126;156;216:*.cfg=0;38;2;215;95;175:*.cgi=0;38;2;149;127;184:*.clj=0;38;2;149;127;184:*.com=1;38;2;142;192;124:*.cpp=0;38;2;149;127;184:*.cr2=0;38;2;126;156;216:*.cr3=0;38;2;126;156;216:*.crw=0;38;2;126;156;216:*.css=0;38;2;149;127;184:*.csv=0;38;2;118;148;106:*.csx=0;38;2;149;127;184:*.cxx=0;38;2;149;127;184:*.dae=0;38;2;126;156;216:*.dcr=0;38;2;126;156;216:*.dcs=0;38;2;126;156;216:*.deb=1;38;2;204;169;93:*.def=0;38;2;149;127;184:*.dll=1;38;2;142;192;124:*.dmg=1;38;2;135;175;95:*.dng=0;38;2;126;156;216:*.doc=1;38;2;230;195;132:*.dot=0;38;2;149;127;184:*.dox=3;38;2;232;36;36:*.dpr=0;38;2;149;127;184:*.drf=0;38;2;126;156;216:*.dxf=0;38;2;126;156;216:*.eip=0;38;2;126;156;216:*.elc=0;38;2;149;127;184:*.elm=0;38;2;149;127;184:*.epp=0;38;2;149;127;184:*.eps=0;38;2;126;156;216:*.erf=0;38;2;126;156;216:*.erl=0;38;2;149;127;184:*.exe=1;38;2;142;192;124:*.exr=0;38;2;126;156;216:*.exs=0;38;2;149;127;184:*.fbx=0;38;2;126;156;216:*.fff=0;38;2;126;156;216:*.fls=3;38;2;68;68;68:*.flv=1;38;2;127;180;202:*.fnt=0;38;2;126;156;216:*.fon=0;38;2;126;156;216:*.fsi=0;38;2;149;127;184:*.fsx=0;38;2;149;127;184:*.gif=0;38;2;126;156;216:*.git=3;38;2;68;68;68:*.gpr=0;38;2;126;156;216:*.gvy=0;38;2;149;127;184:*.h++=0;38;2;149;127;184:*.hda=0;38;2;126;156;216:*.hip=0;38;2;126;156;216:*.hpp=0;38;2;149;127;184:*.htc=0;38;2;149;127;184:*.htm=0;38;2;118;148;106:*.hxx=0;38;2;149;127;184:*.ico=0;38;2;126;156;216:*.ics=1;38;2;230;195;132:*.idx=3;38;2;68;68;68:*.igs=0;38;2;126;156;216:*.iiq=0;38;2;126;156;216:*.ilg=3;38;2;68;68;68:*.img=1;38;2;135;175;95:*.inc=0;38;2;149;127;184:*.ind=3;38;2;68;68;68:*.ini=0;38;2;215;95;175:*.inl=0;38;2;149;127;184:*.ino=0;38;2;149;127;184:*.ipp=0;38;2;149;127;184:*.iso=1;38;2;135;175;95:*.jar=1;38;2;204;169;93:*.jpg=0;38;2;126;156;216:*.jsx=0;38;2;149;127;184:*.jxl=0;38;2;126;156;216:*.k25=0;38;2;126;156;216:*.kdc=0;38;2;126;156;216:*.kex=1;38;2;230;195;132:*.kra=0;38;2;126;156;216:*.kts=0;38;2;149;127;184:*.log=3;38;2;68;68;68:*.ltx=0;38;2;149;127;184:*.lua=0;38;2;149;127;184:*.m3u=0;38;2;126;156;216:*.m4a=0;38;2;126;156;216:*.m4v=1;38;2;127;180;202:*.mdc=0;38;2;126;156;216:*.mef=0;38;2;126;156;216:*.mid=0;38;2;126;156;216:*.mir=0;38;2;149;127;184:*.mkv=1;38;2;127;180;202:*.mli=0;38;2;149;127;184:*.mos=0;38;2;126;156;216:*.mov=1;38;2;127;180;202:*.mp3=0;38;2;126;156;216:*.mp4=1;38;2;127;180;202:*.mpg=1;38;2;127;180;202:*.mrw=0;38;2;126;156;216:*.msi=1;38;2;204;169;93:*.mtl=0;38;2;126;156;216:*.nef=0;38;2;126;156;216:*.nim=0;38;2;149;127;184:*.nix=0;38;2;215;95;175:*.nrw=0;38;2;126;156;216:*.obj=0;38;2;126;156;216:*.obm=0;38;2;126;156;216:*.odp=1;38;2;230;195;132:*.ods=1;38;2;230;195;132:*.odt=1;38;2;230;195;132:*.ogg=0;38;2;126;156;216:*.ogv=1;38;2;127;180;202:*.orf=0;38;2;126;156;216:*.org=0;38;2;118;148;106:*.otf=0;38;2;126;156;216:*.otl=0;38;2;126;156;216:*.out=3;38;2;68;68;68:*.pas=0;38;2;149;127;184:*.pbm=0;38;2;126;156;216:*.pcx=0;38;2;126;156;216:*.pdf=1;38;2;230;195;132:*.pef=0;38;2;126;156;216:*.pgm=0;38;2;126;156;216:*.php=0;38;2;149;127;184:*.pid=3;38;2;68;68;68:*.pkg=1;38;2;204;169;93:*.png=0;38;2;126;156;216:*.pod=0;38;2;149;127;184:*.ppm=0;38;2;126;156;216:*.pps=1;38;2;230;195;132:*.ppt=1;38;2;230;195;132:*.pro=3;38;2;232;36;36:*.ps1=0;38;2;149;127;184:*.psd=0;38;2;126;156;216:*.ptx=0;38;2;126;156;216:*.pxn=0;38;2;126;156;216:*.pyc=3;38;2;68;68;68:*.pyd=3;38;2;68;68;68:*.pyo=3;38;2;68;68;68:*.qoi=0;38;2;126;156;216:*.r3d=0;38;2;126;156;216:*.raf=0;38;2;126;156;216:*.rar=1;38;2;204;169;93:*.raw=0;38;2;126;156;216:*.rpm=1;38;2;204;169;93:*.rst=0;38;2;118;148;106:*.rtf=1;38;2;230;195;132:*.rw2=0;38;2;126;156;216:*.rwl=0;38;2;126;156;216:*.rwz=0;38;2;126;156;216:*.sbt=0;38;2;149;127;184:*.sql=0;38;2;149;127;184:*.sr2=0;38;2;126;156;216:*.srf=0;38;2;126;156;216:*.srw=0;38;2;126;156;216:*.stl=0;38;2;126;156;216:*.stp=0;38;2;126;156;216:*.sty=3;38;2;68;68;68:*.svg=0;38;2;126;156;216:*.swf=1;38;2;127;180;202:*.swp=3;38;2;68;68;68:*.sxi=1;38;2;230;195;132:*.sxw=1;38;2;230;195;132:*.tar=1;38;2;204;169;93:*.tbz=1;38;2;204;169;93:*.tcl=0;38;2;149;127;184:*.tex=0;38;2;149;127;184:*.tga=0;38;2;126;156;216:*.tgz=1;38;2;204;169;93:*.tif=0;38;2;126;156;216:*.tml=0;38;2;215;95;175:*.tmp=3;38;2;68;68;68:*.toc=3;38;2;68;68;68:*.tsx=0;38;2;149;127;184:*.ttf=0;38;2;126;156;216:*.txt=0;38;2;7;102;120:*.typ=0;38;2;118;148;106:*.usd=0;38;2;126;156;216:*.vcd=1;38;2;135;175;95:*.vim=0;38;2;149;127;184:*.vob=1;38;2;127;180;202:*.vsh=0;38;2;149;127;184:*.wav=0;38;2;126;156;216:*.wma=0;38;2;126;156;216:*.wmv=1;38;2;127;180;202:*.wrl=0;38;2;126;156;216:*.x3d=0;38;2;126;156;216:*.x3f=0;38;2;126;156;216:*.xlr=1;38;2;230;195;132:*.xls=1;38;2;230;195;132:*.xml=0;38;2;118;148;106:*.xmp=0;38;2;215;95;175:*.xpm=0;38;2;126;156;216:*.xvf=0;38;2;126;156;216:*.yml=0;38;2;215;95;175:*.zig=0;38;2;149;127;184:*.zip=1;38;2;204;169;93:*.zsh=0;38;2;149;127;184:*.zst=1;38;2;204;169;93:*TODO=0;38;2;232;36;36:*hgrc=3;38;2;232;36;36:*.avif=0;38;2;126;156;216:*.bash=0;38;2;149;127;184:*.braw=0;38;2;126;156;216:*.conf=0;38;2;215;95;175:*.dart=0;38;2;149;127;184:*.data=0;38;2;126;156;216:*.diff=0;38;2;149;127;184:*.docx=1;38;2;230;195;132:*.epub=1;38;2;230;195;132:*.fish=0;38;2;149;127;184:*.flac=0;38;2;126;156;216:*.h264=1;38;2;127;180;202:*.hack=0;38;2;149;127;184:*.heif=0;38;2;126;156;216:*.hgrc=3;38;2;232;36;36:*.html=0;38;2;118;148;106:*.iges=0;38;2;126;156;216:*.info=0;38;2;118;148;106:*.java=0;38;2;149;127;184:*.jpeg=0;38;2;126;156;216:*.json=0;38;2;215;95;175:*.less=0;38;2;149;127;184:*.lisp=0;38;2;149;127;184:*.lock=3;38;2;68;68;68:*.make=3;38;2;232;36;36:*.mojo=0;38;2;149;127;184:*.mpeg=1;38;2;127;180;202:*.nims=0;38;2;149;127;184:*.opus=0;38;2;126;156;216:*.orig=3;38;2;68;68;68:*.pptx=1;38;2;230;195;132:*.prql=0;38;2;149;127;184:*.psd1=0;38;2;149;127;184:*.psm1=0;38;2;149;127;184:*.purs=0;38;2;149;127;184:*.raku=0;38;2;149;127;184:*.rlib=3;38;2;68;68;68:*.sass=0;38;2;149;127;184:*.scad=0;38;2;149;127;184:*.scss=0;38;2;149;127;184:*.step=0;38;2;126;156;216:*.tbz2=1;38;2;204;169;93:*.tiff=0;38;2;126;156;216:*.toml=0;38;2;215;95;175:*.usda=0;38;2;126;156;216:*.usdc=0;38;2;126;156;216:*.usdz=0;38;2;126;156;216:*.webm=1;38;2;127;180;202:*.webp=0;38;2;126;156;216:*.woff=0;38;2;126;156;216:*.xbps=1;38;2;204;169;93:*.xlsx=1;38;2;230;195;132:*.yaml=0;38;2;215;95;175:*stdin=3;38;2;68;68;68:*v.mod=3;38;2;232;36;36:*.blend=0;38;2;126;156;216:*.cabal=0;38;2;149;127;184:*.cache=3;38;2;68;68;68:*.class=3;38;2;68;68;68:*.cmake=3;38;2;232;36;36:*.ctags=3;38;2;68;68;68:*.dylib=1;38;2;142;192;124:*.dyn_o=3;38;2;68;68;68:*.gcode=0;38;2;149;127;184:*.ipynb=0;38;2;149;127;184:*.mdown=0;38;2;118;148;106:*.patch=0;38;2;149;127;184:*.rmeta=3;38;2;68;68;68:*.scala=0;38;2;149;127;184:*.shtml=0;38;2;118;148;106:*.swift=0;38;2;149;127;184:*.toast=1;38;2;135;175;95:*.woff2=0;38;2;126;156;216:*.xhtml=0;38;2;118;148;106:*Icon\r=3;38;2;68;68;68:*LEGACY=0;38;2;243;210;132:*NOTICE=0;38;2;243;210;132:*README=0;38;2;243;210;132:*go.mod=3;38;2;232;36;36:*go.sum=3;38;2;68;68;68:*passwd=0;38;2;215;95;175:*shadow=0;38;2;215;95;175:*stderr=3;38;2;68;68;68:*stdout=3;38;2;68;68;68:*.bashrc=0;38;2;149;127;184:*.config=0;38;2;215;95;175:*.dyn_hi=3;38;2;68;68;68:*.flake8=3;38;2;232;36;36:*.gradle=0;38;2;149;127;184:*.groovy=0;38;2;149;127;184:*.ignore=3;38;2;232;36;36:*.matlab=0;38;2;149;127;184:*.nimble=0;38;2;149;127;184:*COPYING=3;38;2;131;165;152:*INSTALL=0;38;2;243;210;132:*LICENCE=3;38;2;131;165;152:*LICENSE=3;38;2;131;165;152:*TODO.md=0;38;2;232;36;36:*VERSION=0;38;2;243;210;132:*.alembic=0;38;2;126;156;216:*.desktop=0;38;2;215;95;175:*.gemspec=3;38;2;232;36;36:*.mailmap=3;38;2;232;36;36:*Doxyfile=3;38;2;232;36;36:*Makefile=3;38;2;232;36;36:*TODO.txt=0;38;2;232;36;36:*setup.py=3;38;2;232;36;36:*.DS_Store=3;38;2;68;68;68:*.cmake.in=3;38;2;232;36;36:*.fdignore=3;38;2;232;36;36:*.kdevelop=3;38;2;232;36;36:*.markdown=0;38;2;118;148;106:*.rgignore=3;38;2;232;36;36:*.tfignore=3;38;2;232;36;36:*CHANGELOG=0;38;2;243;210;132:*COPYRIGHT=3;38;2;131;165;152:*README.md=0;38;2;243;210;132:*bun.lockb=3;38;2;68;68;68:*configure=3;38;2;232;36;36:*.gitconfig=3;38;2;232;36;36:*.gitignore=3;38;2;232;36;36:*.localized=3;38;2;68;68;68:*.scons_opt=3;38;2;68;68;68:*.timestamp=3;38;2;68;68;68:*CODEOWNERS=3;38;2;232;36;36:*Dockerfile=0;38;2;215;95;175:*INSTALL.md=0;38;2;243;210;132:*README.txt=0;38;2;243;210;132:*SConscript=3;38;2;232;36;36:*SConstruct=3;38;2;232;36;36:*.cirrus.yml=0;38;2;230;195;132:*.gitmodules=3;38;2;232;36;36:*.synctex.gz=3;38;2;68;68;68:*.travis.yml=0;38;2;230;195;132:*INSTALL.txt=0;38;2;243;210;132:*LICENSE-MIT=3;38;2;131;165;152:*MANIFEST.in=3;38;2;232;36;36:*Makefile.am=3;38;2;232;36;36:*Makefile.in=3;38;2;68;68;68:*.applescript=0;38;2;149;127;184:*.fdb_latexmk=3;38;2;68;68;68:*.webmanifest=0;38;2;215;95;175:*CHANGELOG.md=0;38;2;243;210;132:*CONTRIBUTING=0;38;2;243;210;132:*CONTRIBUTORS=0;38;2;243;210;132:*appveyor.yml=0;38;2;230;195;132:*configure.ac=3;38;2;232;36;36:*.bash_profile=0;38;2;149;127;184:*.clang-format=3;38;2;232;36;36:*.editorconfig=3;38;2;232;36;36:*CHANGELOG.txt=0;38;2;243;210;132:*.gitattributes=3;38;2;232;36;36:*.gitlab-ci.yml=0;38;2;230;195;132:*CMakeCache.txt=3;38;2;68;68;68:*CMakeLists.txt=3;38;2;232;36;36:*LICENSE-APACHE=3;38;2;131;165;152:*pyproject.toml=3;38;2;232;36;36:*CODE_OF_CONDUCT=0;38;2;243;210;132:*CONTRIBUTING.md=0;38;2;243;210;132:*CONTRIBUTORS.md=0;38;2;243;210;132:*.sconsign.dblite=3;38;2;68;68;68:*CONTRIBUTING.txt=0;38;2;243;210;132:*CONTRIBUTORS.txt=0;38;2;243;210;132:*requirements.txt=3;38;2;232;36;36:*package-lock.json=3;38;2;68;68;68:*CODE_OF_CONDUCT.md=0;38;2;243;210;132:*.CFUserTextEncoding=3;38;2;68;68;68:*CODE_OF_CONDUCT.txt=0;38;2;243;210;132:*azure-pipelines.yml=0;38;2;230;195;132"

      if uwsm check may-start; then
        exec uwsm start hyprland-uwsm.desktop
      fi

      function ranger-cd() {
        temp_file="$(mktemp -t "ranger_cd.XXXXXXXXXX")"
        ranger --choosedir="$temp_file" -- "''\${@:-$PWD}"
        if chosen_dir="$(cat -- "$temp_file")" && [ -n "$chosen_dir" ] && [ "$chosen_dir" != "$PWD" ]; then
        cd -- "$chosen_dir"
        fi
        rm -f -- "$temp_file"
      }
    '';
  };

  programs.fzf = {
    enable = true;
    enableZshIntegration = true;
  };
}
